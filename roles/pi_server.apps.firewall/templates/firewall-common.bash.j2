# -*- mode: sh -*-
# Sourced by the other firewall scripts

function valid-protocol() {
    if [ "${1}" = 'tcp' ] || [ "${1}" = 'udp' ]; then
        return 0
    else
        return 1
    fi
}

function valid-port() {
    if [ -n "${1}" ]; then
        if [[ "${1}" != *[!0-9]* ]]; then
            if (( "${1}" >= 0 && "${1}" <= 65535 )); then
                return 0
            fi
        fi
    fi
    return 1
}

function open-at-boot-file() {
    if [ "${1}" = 'tcp' ]; then
        echo '{{ pi_server_apps_firewall_tcp_open_boot }}'
    elif [ "${1}" = 'udp' ]; then
        echo '{{ pi_server_apps_firewall_udp_open_boot }}'
    fi
}
