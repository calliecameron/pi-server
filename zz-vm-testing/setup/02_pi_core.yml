---
- name: 02-pi-core - 01-vars
  command:
    cmd: "{{ pi_core }}/01-vars"
    stdin: |
      {{ pi_lan_mask }}
      {{ pi_vpn_mask }}
      {{ storage_drive_dev }}
      {{ storage_data_partition }}
      {{ storage_backup_partition }}
      n

- name: 02-pi-core - 04-nginx - add certs repo
  become: yes
  apt_repository:
    repo: "deb [trusted=yes check-date=no date-max-future=86400] http://{{ internet_ip }}:8080/ certs certs"
- name: 02-pi-core - 04-nginx - install certs
  become: yes
  package: name="{{ inventory_hostname }}-server-certs"
- name: 02-pi-core - 04-nginx
  command:
    cmd: "{{ pi_core }}/04-nginx"

- name: 02-pi-core - 06-storage-drives
  command:
    cmd: "{{ pi_core }}/06-storage-drives"
    stdin: |
      y
      y
      y
- name: 02-pi-core - 06-storage-drives - mount
  become: yes
  command:
    cmd: "mount -a"

- name: 02-pi-core - 07-storage-directories
  command:
    cmd: "{{ pi_core }}/07-storage-directories"

- name: 02-pi-core - 08-openvpn-server
  command:
    cmd: "{{ pi_core }}/08-openvpn-server"
    stdin: |
      y
      y

- name: 02-pi-core - 09-backup
  command:
    cmd: "{{ pi_core }}/09-backup"
    stdin: |
      y
